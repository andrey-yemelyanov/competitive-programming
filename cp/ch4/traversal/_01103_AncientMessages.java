package helvidios.cp.ch4.traversal;

import java.util.*;
import static java.lang.Math.*;

public class _01103_AncientMessages{
	public static void main(String[] args){
		String data = "6 2\r\n00\r\n7c\r\n44\r\n7c\r\n30\r\n00\r\n6 25\r\n0000000000000000000000000\r\n0000000000000000000000000\r\n00001fe0000000000007c0000\r\n00003fe0000000000007c0000\r\n0000000000000000000000000\r\n0000000000000000000000000\r\n10 3\r\n000\r\n778\r\n548\r\n748\r\n578\r\n700\r\n000\r\n7f0\r\n1e0\r\n000\r\n16 2\r\n00\r\n7e\r\n42\r\n7e\r\n42\r\n7e\r\n42\r\n7e\r\n42\r\n7e\r\n42\r\n7e\r\n00\r\n00\r\n4a\r\n00\r\n16 1\r\n0\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n8\r\n9\r\na\r\nb\r\nc\r\nd\r\ne\r\nf\r\n9 2\r\n00\r\n7e\r\n42\r\n7e\r\n42\r\n7e\r\n42\r\n7e\r\n00\r\n43 2\r\n00\r\n7e\r\n00\r\n7e\r\n42\r\n7e\r\n42\r\n7e\r\n42\r\n7e\r\n00\r\n7e\r\n42\r\n7e\r\n00\r\n7e\r\n42\r\n7e\r\n42\r\n7e\r\n00\r\n7e\r\n42\r\n7e\r\n42\r\n7e\r\n42\r\n7e\r\n42\r\n7e\r\n00\r\n7e\r\n42\r\n7e\r\n42\r\n7e\r\n42\r\n7e\r\n42\r\n7e\r\n42\r\n7e\r\n00\r\n200 50\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n10000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n10000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n10000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n10000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n10000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n10000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n10000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n10000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n10000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n10000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n10000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n10000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n10000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n10000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n10000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n10000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n10000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n10000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n10000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n00000000000000000000000000000000000000000000000000\r\n10000000000000000000000000000000000000000000000000\r\n100 25\r\n0000000000000000000000000\r\n0000000000000000000000000\r\n0000000000000000000000000\r\n0000000000000000000000000\r\n0000000000000000000000000\r\n0000000000000000000000000\r\n0000000000000000000000000\r\n0000000000000000000000000\r\n0000000000000000000000000\r\n00000f8000000000000000000\r\n00001fe000000000000000000\r\n00007ff000000000000000000\r\n00007ff800000000000000000\r\n0000f8f800000000000000000\r\n0001f07c00000000000000000\r\n0001e03c00000000001800000\r\n0001e01c00000000003c00000\r\n0001c01c00000000007c00000\r\n0003c01e0000000000f800000\r\n0003c01e0000000001f000000\r\n0001c01c0000000003f000000\r\n0001c01c0000000007e000000\r\n0001e01c000000000fc000000\r\n0001e03c000000001fc000000\r\n0000e03c000000001fc000000\r\n0000f038000000003ff000000\r\n0000f078000000003ff800000\r\n00007870000000007ff800000\r\n000038f0000000007cfc00000\r\n00003ce0000000007c7c00000\r\n00781fc0f0000000f87c00000\r\n007ffffff0000000f07c00000\r\n007ffffff0000000f07c00000\r\n007ffffff0000001f07c00000\r\n007ffffff0000000e03e00000\r\n007fcf81f0000000603e00000\r\n00000f8000000000003e00000\r\n00000f8000000000003e00000\r\n00000f8000000000003e00000\r\n00000f8000000000001e00000\r\n00000f8000000000001f00000\r\n00000fc000000000001f00000\r\n00000fc000000000001f00000\r\n00000fc000000000001f00000\r\n00000fc000000000000f00000\r\n00001fc000000000000f80000\r\n00001fc000000000000f80000\r\n00001fc000000000000f80000\r\n00001fc000000000000f80000\r\n00001fe000000000000f80000\r\n00001fe000000000000780000\r\n00001fe0000000000007c0000\r\n00001fe0000000000007c0000\r\n00003fe0000000000007c0000\r\n00003fe0000000000007c0000\r\n00003fe0000000000007c0000\r\n00003fe0000c00000003c0000\r\n00000000003ff0000003c0000\r\n00000000007ff8000003e0000\r\n0000000001fffc000003e0000\r\n0000000003e03f000003e0000\r\n0000000007c00f000003e0000\r\n000000000f0003800003f0000\r\n000000000e0001c00003fc000\r\n000000001c0001e00007fe000\r\n000000003c0000e0000fff000\r\n000000073c000070000fdf000\r\n0000001ff8000070001f0f800\r\n0000001ff8000070001e07800\r\n0000003cf0000078001e03800\r\n0000003870000033001e03800\r\n000000307800003fc01e03800\r\n000000703800007fe00e03800\r\n000000703800007ce00e03800\r\n000000703c000078700703800\r\n000000701e0000f0700701000\r\n000000701e0000e0700300000\r\n000000700f0001c0700000000\r\n0000006007800380600000000\r\n000000e003e00700600000000\r\n000000e001fe7e00600000000\r\n000000e000fffc00e00000000\r\n000000e0000ff000e00000000\r\n000000f800038000e00000000\r\n000000fff0000000e00000000\r\n000000fffff00000e00000000\r\n00000003ffffe000c00000000\r\n0000000007ffffc0c00000000\r\n000000000007ffffc00000000\r\n0000000000000fffc00000000\r\n000000000000001fc00000000\r\n0000000000000000000000000\r\n0000000000000000000000000\r\n0000000000000000000000000\r\n0000000000000000000000000\r\n0000000000000000000000000\r\n0000000000000000000000000\r\n0000000000000000000000000\r\n0000000000000000000000000\r\n0000000000000000000000000\r\n150 38\r\n00000000000000000000000000000000000000\r\n00000000000000000000000000000000000000\r\n00000000000000000000000000000000000000\r\n00000000000000000000000000000000000000\r\n00000000000000000000000000000000000000\r\n00000000000000000000000000000000000000\r\n00000000000000000000000000000000000000\r\n00000000000000000000000000000000000000\r\n00000000000000000000000000003000000000\r\n00000f80000000001fff000000007800000000\r\n00001fe0000000007fff80000000ff00000000\r\n00007ff000000000ffffe0000001ff80000000\r\n00007ff800000003fffff0000001fffc000000\r\n0000f8f800000007fffffc000001fffe000000\r\n0001f07c0000000ffffffe000000ffff000000\r\n0001e03c0000001fffffff000000ffff800000\r\n0001e01c0000003fffffff0000007fffc00000\r\n0001c01c0000003fffffff8000007fefc00000\r\n0003c01e0000007fffffffc000003f83c00000\r\n0003c01e000000ffffffffc000001f81e00000\r\n0001c01c000000fffc0fffe000001f01e00000\r\n0001c01c000001fff003ffe000000f01e00000\r\n0001e01c000001ffe001fff000000f00e00000\r\n0001e03c000003ffc0007ff000001e00f00000\r\n0000e03c000003ff80007ff800001e00f00000\r\n0000f038000007ff80003ff800001e00f00000\r\n0000f078000007ff00003ff800001e00f00000\r\n00007870000007ff00001ffc00000e00e00000\r\n000038f000000fff00001ffc00000e00e00000\r\n00003ce000000ffe00000ffc00000e00e00000\r\n00781fc0f0000ffe00000ffc00000f00e00000\r\n007ffffff0000ffc00000ffc00000f01e00000\r\n007ffffff0000ffc00000ffc00000f01e00000\r\n007ffffff0000ffc00000ffc00000701c00000\r\n007ffffff0000ffc00000ffc00000781c00000\r\n007fcf81f0000ffc000007fc00000783c00000\r\n00000f8000000ffc000007fc00000383800000\r\n00000f8000000ffc000007fc000003c7800000\r\n00000f8000000ffc000007fc000001c7800000\r\n00000f8000000ffc000007fc000001e7000000\r\n00000f8000000ffc000007fc000200ef008000\r\n00000fc000000ffc00000ffc0003f8fe3f8000\r\n00000fc000000ffc00000ffc0003ffffff8000\r\n00000fc000000ffc00000ffc0003ffffff8000\r\n00000fc000000ffc00000ffc0003ffffff8000\r\n00001fc000000ffc00000ffc0003ffffff8000\r\n00001fc0000007fe00000ff80003ffffff8000\r\n00001fc0000007fe00000ff80003fffdff8000\r\n00001fc0000007fe00000ff80003c03c000000\r\n00001fe0000007ff00001ff80000007c000000\r\n00001fe0000003ff00001ff00000007c000000\r\n00001fe0000003ff00001ff00000007c000000\r\n00001fe0000001ff80003ff00000007c000000\r\n00003fe0000001ff80003fe00000007c000000\r\n00003fe0000001ff80003fe00000007c000000\r\n00003fe0000000ffc0007fe00000007c000000\r\n00003fe0000000ffc0007fc00000007c000000\r\n000000000000007fe0007fc00000007c000000\r\n000000000000007fe000ff800000007c000000\r\n000000000000007ff001ff800000007c000000\r\n000000000000003ff001ff800000007c000000\r\n000000000000001ff803ff000000007c002000\r\n000000000000001ff803ff000000007c006000\r\n000000000000000ffc07fe000000007c006000\r\n000000000000000ffc0ffc000000007c00c000\r\n000000000000000ffe0ffc000000003e01c000\r\n0000000000000007ff0ff8000000003f03c000\r\n0000000000000003ff1ff0000000003f8f8000\r\n0000000003c00001ffbff00000f0001fff8000\r\n0000000003ffc001ffffe0007ff0000fff8000\r\n0000000003fffff1ffffe3fffff00007ff8000\r\n0000000003fffffffffffffffff00001ff0000\r\n0000000003fffffffffffffffff00000ff0000\r\n0000000003fffffffffffffffff000007f0000\r\n0000000003fffffffffffffffff000001e0000\r\n0000000003fffffffffffffffff000000e0000\r\n0000000003fffffffffffffffff00000020000\r\n0000000003fffffffffffffffff00000000000\r\n0000000003fffffffffffffffff00000000000\r\n0000000003fffffffffffffffff00000000000\r\n0000000003fffffffffffffffff00000000000\r\n0000000003fffffffffffffffff00000000000\r\n0000000003fffffffffffffffff00000000000\r\n0000000003fffffc1ffe0007fff00000000000\r\n0000000003ff80000ffe000000f00000000000\r\n00000000038000000ffe000000000000000000\r\n00000000000000001fff000000000000000000\r\n00000000000000001fff000000000000000000\r\n00000000000000001fff000000000000000000\r\n00000000000000001fff000000000000000000\r\n00000000000000001fff000000000000000000\r\n00000000000000001fff000000000000000000\r\n00000000000000003fff000000000000000000\r\n00000000000000003fff000000000000000000\r\n00000000000000003fff0000000fc000000000\r\n000000000fe000003fff8000003ff000000000\r\n000000003ffc00003fff8000007ffc00000000\r\n00000000fffe00003fff800000fcfc00000000\r\n00000001f01f00003fff800001f03e00000000\r\n00000003e00f80003fff800003e01f00000000\r\n00000003e00780003fff800003e00f00000000\r\n00000003e00780003fff800003c00f00000000\r\n00000003e00f80003fff800003c00f00000000\r\n00000001f00f00007fff800003c00f00000000\r\n00000000f81e00007fffc00003e00f00000000\r\n000000007c3c00007fffc00001e01e00000000\r\n000000003e7800007fffc00000f01e00000000\r\n000000fffffffe007fffc00000f03c00000000\r\n000000fffffffe007fffc00000787800000000\r\n000000fffffffe007fffc000003cf000000000\r\n0000000007c000007fffe000f81fe07c000000\r\n0000000007e000007fffe000fffffffc000000\r\n0000000007e000007fffe000fffffffc000000\r\n000000000fe000007fffe000fffffffc000000\r\n000000000ff00000ffffe000ffc7c0fc000000\r\n000000000ff00000ffffe0000007c000000000\r\n000000001ff00000ffffe000000fc000000000\r\n000000001ff00000ffffe000000fc000000000\r\n000000001ff80000ffffe000000fc000000000\r\n000000001ff80000ffffe000000fc000000000\r\n000000003ff80001ffffe000000fe000000000\r\n000000003ff80001ffffe000000fe000000000\r\n0000000000000001fffff000001fe000000000\r\n0000000000000001fffff000001fe000000000\r\n0000000000000001fffff000001fe000000000\r\n0000000000000001fffff000001ff000000000\r\n0000000000000001fffff000001ff000000000\r\n0000000000000001fffff000001ff000000000\r\n0000000000000001fffff000003ff000000000\r\n0000000000000001fffff000003ff000000000\r\n0000000000000001fffff000003ff000000000\r\n0000000000000001fffff80000000000000000\r\n0000000000000003fffff80000000000000000\r\n0000000000000003fffff80000000000000000\r\n0000000000000003fffff80000000000000000\r\n0000000000000003fffff80000000000000000\r\n0000000000000003fffff80000000000000000\r\n0000000000000003fffff80000000000000000\r\n0000000000000003fffff80000000000000000\r\n0000000000000003fffffc0000000000000000\r\n0000000000000003fffffc0000000000000000\r\n0000000000000007fffffc0000000000000000\r\n0000000000000007fffffc0000000000000000\r\n0000000000000007fffffc0000000000000000\r\n00000000000000000000000000000000000000\r\n00000000000000000000000000000000000000\r\n00000000000000000000000000000000000000\r\n00000000000000000000000000000000000000\r\n00000000000000000000000000000000000000\r\n00000000000000000000000000000000000000\r\n0 0\r\n";
		String data2 = "6 25\r\n0000000000000000000000000\r\n0000000000000000000000000\r\n00001fe0000000000007c0000\r\n00003fe0000000000007c0000\r\n0000000000000000000000000\r\n0000000000000000000000000\r\n0 0";
		Scanner s = new Scanner(data);
		int caseNum = 1;
		while(s.hasNext()){
			int r = s.nextInt();
			int c = s.nextInt();
			if(r == 0 && c == 0) break;
			int[][] image = new int[r][];
			for(int i = 0; i < r; i++){
				String hexString = s.next();
				image[i] = toBitArray(hexString);
			}
			List<Integer> result = findHieroglyphs(image);
			char[] str = new char[result.size()];
			for(int i = 0; i < str.length; i++){
				str[i] = h[result.get(i)];
			}
			Arrays.sort(str);
			System.out.printf("Case %d: %s\n", caseNum++, new String(str));
		}
	}

	static Map<Character, Integer[]> hex = new HashMap<>();
	static{
		hex.put('0', new Integer[]{0,0,0,0});
		hex.put('1', new Integer[]{0,0,0,1});
		hex.put('2', new Integer[]{0,0,1,0});
		hex.put('3', new Integer[]{0,0,1,1});
		hex.put('4', new Integer[]{0,1,0,0});
		hex.put('5', new Integer[]{0,1,0,1});
		hex.put('6', new Integer[]{0,1,1,0});
		hex.put('7', new Integer[]{0,1,1,1});
		hex.put('8', new Integer[]{1,0,0,0});
		hex.put('9', new Integer[]{1,0,0,1});
		hex.put('a', new Integer[]{1,0,1,0});
		hex.put('b', new Integer[]{1,0,1,1});
		hex.put('c', new Integer[]{1,1,0,0});
		hex.put('d', new Integer[]{1,1,0,1});
		hex.put('e', new Integer[]{1,1,1,0});
		hex.put('f', new Integer[]{1,1,1,1});
	}
	static int[] toBitArray(String hexString){
		int[] bitArray = new int[hexString.length() * 4];
		for(int i = 0, k = 0; i < hexString.length(); i++, k += 4){
			Integer[] bits = hex.get(hexString.charAt(i));
			for(int j = 0; j < bits.length; j++){
				bitArray[k + j] = bits[j];
			}
		}
		return bitArray;
	}

	static List<Integer> findHieroglyphs(int[][] image){
		Map<Integer, Integer> map = new HashMap<>();
		int color = 2;
		int nHieroglyphs = 0;
		for(int i = 0; i < image.length; i++){
			for(int j = 0; j < image[i].length; j++){
				if(image[i][j] == 1){
					floodfill(image, i, j, 1, color, new HashSet<Integer>());
					nHieroglyphs++;
					color++;
				}
			}
		}

		for(int i = 0; i < image.length; i++){
			for(int j = 0; j < image[i].length; j++){
				if(image[i][j] == 0){
					Set<Integer> s = new HashSet<>();
					floodfill(image, i, j, 0, color, s);
					color++;
					if(s.size() == 1){
						int hieroglyph = s.toArray(new Integer[0])[0];
						if(hieroglyph != -1){
							if(!map.containsKey(hieroglyph)) map.put(hieroglyph, 0);
							map.put(hieroglyph, map.get(hieroglyph) + 1);	
						}
					}
				}
			}
		}

		if(map.size() < nHieroglyphs){
			int n = nHieroglyphs - map.size();
			for(int i = 0; i < n; i++){
				map.put(color++, 0);
			}
		}

		return new ArrayList<Integer>(map.values());		
	}

	static final char[] h = new char[] {'W', 'A', 'K', 'J', 'S', 'D'};
	static int[] dr = new int[]{-1, 0, 1, 0};
	static int[] dc = new int[]{0, 1, 0, -1};
	static void floodfill(int[][] image, int row, int col, int color, int newColor, Set<Integer> surroundedBy){
		if(row < 0 || row >= image.length || col < 0 || col >= image[0].length){
			surroundedBy.add(-1);
			return;
		}
		if(image[row][col] != color){
			if(image[row][col] != newColor) surroundedBy.add(image[row][col]);
			return;
		}
		image[row][col] = newColor;
		for(int d = 0; d < 4; d++){
			floodfill(image, row + dr[d], col + dc[d], color, newColor, surroundedBy);
		}
	}
}